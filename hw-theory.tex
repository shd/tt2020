\documentclass[10pt,a4paper,oneside]{article}
\usepackage[utf8]{inputenc}
\usepackage[english,russian]{babel}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{enumerate}
\usepackage{stmaryrd}
\usepackage{cmll}
\usepackage{mathrsfs}
\usepackage[left=2cm,right=2cm,top=2cm,bottom=2cm,bindingoffset=0cm]{geometry}
\usepackage{proof}
\usepackage{tikz}
\usepackage{multicol}

\makeatletter
\newcommand{\dotminus}{\mathbin{\text{\@dotminus}}}

\newcommand{\@dotminus}{%
  \ooalign{\hidewidth\raise1ex\hbox{.}\hidewidth\cr$\m@th-$\cr}%
}
\makeatother

\usetikzlibrary{arrows,backgrounds,patterns,matrix,shapes,fit,calc,shadows,plotmarks}

\newtheorem{definition}{Определение}
\begin{document}

\begin{center}{\Large\textsc{\textbf{Теоретические (``малые'') домашние задания}}}\\
             \it Теория типов, ИТМО, М3235-М3239, весна 2020 года\end{center}

\section*{Домашнее задание №1: <<вводная лекция для ТТ и ФП>>}

\begin{enumerate}

\item Напомним определения с лекций:

\begin{tabular}{lll}
Обозначение & лямбда-терм & название\\\hline
$T$ & $\lambda a.\lambda b.a$ & истина\\
$F$ & $\lambda a.\lambda b.b$ & ложь\\
$Not$ & $\lambda x.x\ F\ T$ & отрицание\\
$And$ & $\lambda x.\lambda y.x\ y\ F$ & конъюнкция
\end{tabular}

Проредуцируйте следующие выражения и найдите нормальную форму:

\begin{enumerate}
\item $T\ F$
\item $(T\ Not\ (\lambda t.t))\ F$
\item $And\ F\ T$
\item $And\ T\ T$
\end{enumerate}

\item Постройте лямбда-выражения для следующих булевских выражений:
\begin{enumerate}
\item Дизъюнкция
\item Штрих Шеффера (<<и-не>>)
\item Исключающее или
\end{enumerate}

\item Напомним определения с лекций:

$$f^{(n)}\ X ::= \left\{\begin{array}{ll} X, & n=0\\
                                f^{(n-1)}\ (f\ X), & n>0\end{array}\right.$$

\begin{center}\begin{tabular}{lll}
Обозначение & лямбда-терм & название\\\hline
$\overline{n}$ & $\lambda f.\lambda x.f^{(n)}\ x$ & чёрчевский нумерал\\
$(+1)$ & $\lambda n.\lambda f.\lambda x.n\ f\ (f\ x)$ & прибавление 1\\
$IsZero$ & $\lambda n.n\ (\lambda x.F)\ T$ & проверка на 0
\end{tabular}\end{center}

Используя данные определения, постройте выражения для следующих операций над числами:

\begin{enumerate}
\item Сложение
\item Умножение на 2 ($Mul2$)
\item Умножение
\item Возведение в степень
\item Проверка на чётность
\item Деление на 3
\item Сравнение двух чисел ($IsLess$) — истина, если первый аргумент меньше второго
\end{enumerate}

\item Проредуцируйте выражение и найдите его нормальную форму: 
\begin{enumerate}
\item $\overline{2}\ \overline{2}$
\item $\overline{2}\ \overline{2}\ \overline{2}$
\item $\overline{2}\ \overline{2}\ \overline{2}\ \overline{2}\ \overline{2}\ \overline{2}\ \overline{2}$
\end{enumerate}

\item Напомним определения с лекций:

\begin{tabular}{lll}
Обозначение & лямбда-терм & название\\\hline
$MkPair$ & $\lambda a.\lambda b.(\lambda x.x\ a\ b)$ & создание пары\\
$PrL$ & $\lambda p.p\ T$ & левая проекция\\
$PrR$ & $\lambda p.p\ F$ & правая проекция\\\hline
$Case$ & $\lambda l.\lambda r.\lambda c.c\ l\ r$ & case для алгебраического типа\\
$InL$ & $\lambda l.(\lambda x.\lambda y.l\ x\ y)$ & левая инъекция\\
$InR$ & $\lambda r.(\lambda x.\lambda y.r\ x\ y)$ & правая инъекция\\
\end{tabular}

\begin{enumerate}
\item Убедитесь, что $PrL\ (MkPair\ a\ b) \twoheadrightarrow_\beta a$.
\item Убедитесь, что $Case\ (\lambda x.T)\ (\lambda y.y)\ (InR\ p) \twoheadrightarrow_\beta p$.
\item Постройте операцию вычитания 1 из числа
\item Постройте операцию вычитания чисел
\item Постройте опреацию деления чисел
\end{enumerate}

\item Напомним определение Y-комбинатора: $\lambda f.(\lambda x.f\ (x\ x))\ (\lambda x.f\ (x\ x))$.
\begin{enumerate}
\item Покажите, что выражение $Y\ f$ не имеет нормальной формы;
\item Покажите, что выражение $Y\ (\lambda f.\overline{0})$ имеет нормальную форму.
\item Покажите, что выражение $Y\ (\lambda f.\lambda x.(IsZero\ x)\ \overline{0}\ (f\ Minus1\ x))\ 2$ имеет нормальную форму.
\item Какова нормальная форма выражения $Y\ (\lambda f.\lambda x.(IsZero\ x)\ \overline{0}\ ((+1)\ (f\ Minus1\ x)))\ \overline{n}$?
\item Какова нормальная форма выражения $Y\ (\lambda f.\lambda x.(IsZero\ x)\ \overline{1}\ (Mul2\ (f\ Minus1\ x)))\ \overline{n}$?
\item Определите с помощью $Y$-комбинатора функцию для вычисления $n$-го числа Фибоначчи.
\end{enumerate}

\item Пусть $\eta = (\alpha\rightarrow\alpha)\rightarrow(\alpha\rightarrow\alpha)$. Покажите (т.е. постройте
соответствующее доказательство в исчислении по Карри), что:
\begin{enumerate}
\item $\vdash \overline{2} : \eta$.
\item $\vdash (+1) : \eta\rightarrow\eta$.
\item $\vdash Plus : \eta\rightarrow\eta$.
\item $\vdash Mul : \eta\rightarrow\eta$ (не каждая реализация умножения будет удовлетворять этому свойству;
вам требуется найти нужную)
\end{enumerate}

\item Определим на языке Хаскель следующую функцию: \verb!show_church n = show (n (+1) 0)!
Убедитесь, что \verb!show_church (\f -> \x -> f (f x))! вернёт 2. 
Пользуясь данным определением и его идеей, реализуйте следующие функции:

\begin{enumerate}
\item \verb!int_to_church! --- возвращает чёрчевский нумерал (т.е. функцию от двух аргументов) по целому числу.
Каков точный тип результата этой функции?
\item сложение двух чёрчевских нумералов.
\item умножение двух чёрчевских нумералов.
\item можно ли определить вычитание 1 и вычитание? Что получается, а что --- нет?
\end{enumerate}

\item Типы для конъюнкции и дизъюнкции на Хаскеле. Списки.

Заметим, что список (например, целых чисел) — это алгебраический тип: 

\verb!List = Nil | Cons Integer List!.

Можно сконструировать значение данного типа: \verb!Cons 3 (Cons 5 Nil)!.
Можно, например, вычислить его длину:
\begin{verbatim}
length Nil = 0
length (Cons _ tail) = length tail + 1
\end{verbatim}

Определим $Nil = InL\ 0$, а $Cons\ a\ b = InR\ (MkPair\ a\ b)$. Заметим, что теперь списки могут быть впрямую
перенесены в лямбда выражения. Тогда, используя данную идею, реализуйте в Хаскеле:

\begin{enumerate}
\item определите конструкции mkpair, prl, prr на Хаскеле --- какой тип у данных конструкций? Сравните его с типом конъюнкции с лекции.
\item определите конструкции case, inl, inr --- какой тип у данных конструкций? Сравните его с типом дизъюнкции с лекции.
\item постройте список целых чисел из данных конструкий.
\item определите функцию вычисления длины списка целых чисел с помощью данных конструкций (к сожалению, скомпилировать это
выражение на Хаскеле не получится — поэтому достаточно написать исходный код).
\end{enumerate}

\end{enumerate}

\end{document}
